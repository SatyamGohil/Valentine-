<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Will You Be My Valentine? üíñ</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --hot:#ff2e6f;
      --pink:#ff4d88;
      --rose:#ff7aa7;
      --stroke: rgba(255,255,255,.18);
      --shadow: 0 34px 110px rgba(0,0,0,.45);
      --soft: cubic-bezier(.2,.9,.2,1);
    }
    *{box-sizing:border-box}

    body{
      margin:0;
      min-height:100vh;
      overflow:hidden;
      color:#fff;
      font-family: Inter, system-ui, Arial, sans-serif;
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(255,46,111,.28), transparent 60%),
        radial-gradient(1000px 600px at 80% 20%, rgba(255,122,167,.20), transparent 55%),
        radial-gradient(900px 600px at 50% 80%, rgba(255,255,255,.08), transparent 60%),
        linear-gradient(180deg, #060610 0%, #0b0b1a 45%, #070712 100%);
      animation: bgDrift 14s ease-in-out infinite alternate;
    }
    @keyframes bgDrift{
      0%{ filter: saturate(1) brightness(1); }
      100%{ filter: saturate(1.08) brightness(1.03); }
    }

    body::before{
      content:"";
      position:fixed;
      inset:0;
      background: radial-gradient(circle at center, transparent 55%, rgba(0,0,0,.55) 100%);
      pointer-events:none;
      z-index:0;
    }
    body::after{
      content:"";
      position:fixed;
      inset:-60px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.14'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.16;
      pointer-events:none;
      z-index:0;
    }

    /* ===== Emojis (always BEHIND) ===== */
    .float{
      position: fixed;
      bottom:-30px;
      left:0;
      opacity:0;
      pointer-events:none;
      z-index: 1;
      filter: blur(.6px) drop-shadow(0 12px 16px rgba(255,46,111,.10));
      animation: floatUp var(--dur) var(--ease) forwards;
      font-size: var(--fs);
    }
    @keyframes floatUp{
      0%{ transform: translateY(0) translateX(0) scale(.9) rotate(0deg); opacity:0; }
      15%{ opacity:.7; }
      100%{ transform: translateY(-115vh) translateX(var(--drift)) scale(1.12) rotate(var(--rot)); opacity:0; }
    }

    .keepEmoji{
      position: fixed;
      z-index: 1;
      pointer-events:none;
      opacity:0;
      filter: blur(.8px) drop-shadow(0 14px 18px rgba(255,46,111,.10));
      animation: riseSettle var(--dur) var(--soft) forwards;
      font-size: var(--fs);
    }
    @keyframes riseSettle{
      0%{ transform: translateY(0) scale(.85); opacity:0; }
      18%{ opacity:.85; }
      100%{ transform: translateY(var(--rise)) scale(1); opacity:.55; }
    }

    /* ===== Intro ===== */
    .intro{
      position:fixed;
      inset:0;
      z-index: 999;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(1000px 600px at 50% 45%, rgba(255,46,111,.20), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.96), rgba(0,0,0,.86));
      backdrop-filter: blur(6px);
      opacity: 1;
      transition: opacity .9s var(--soft);
    }
    .intro.fadeOut{ opacity:0; pointer-events:none; }

    .introBox{
      width:min(860px, 92vw);
      border-radius: 26px;
      padding: 28px 24px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      box-shadow: 0 40px 140px rgba(0,0,0,.55);
      overflow:hidden;
      position:relative;
      z-index: 1000;
    }
    .introGlow{
      position:absolute;
      inset:-140px -140px auto auto;
      width: 560px;
      height: 560px;
      border-radius: 50%;
      background: radial-gradient(circle at center, rgba(255,46,111,.45), transparent 65%);
      opacity:.6;
      animation: introGlow 6s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes introGlow{
      from{ transform: translate(0,0) scale(1) rotate(0deg); opacity:.52; }
      to{ transform: translate(-18px, 14px) scale(1.07) rotate(10deg); opacity:.72; }
    }
    .scanline{
      position:absolute;
      inset:-30% 0 auto 0;
      height: 220px;
      background: linear-gradient(180deg, transparent, rgba(255,255,255,.08), transparent);
      opacity:.22;
      transform: translateY(-60px);
      animation: scan 3.2s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes scan{
      0%{ transform: translateY(-80px); opacity:.08; }
      45%{ opacity:.22; }
      100%{ transform: translateY(520px); opacity:.08; }
    }

    .introTitle{
      font-family: Cinzel, serif;
      font-size: clamp(26px, 4vw, 46px);
      margin: 0 0 10px;
      letter-spacing: .9px;
      text-align:center;
      text-shadow: 0 18px 50px rgba(255,46,111,.22);
      opacity:0;
      transform: translateY(8px);
      animation: inUp .8s var(--soft) forwards;
      position:relative;
      z-index:1;
    }
    @keyframes inUp{ to{ opacity:1; transform: translateY(0); } }

    .scene{ margin-top: 14px; display:grid; gap:10px; position:relative; z-index:1; }
    .line{
      padding: 14px 14px;
      border-radius: 18px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.14);
      line-height:1.55;
      opacity:0;
      transform: translateY(14px);
      filter: blur(2px);
      transition: opacity .55s var(--soft), transform .55s var(--soft), filter .55s var(--soft);
    }
    .line.show{ opacity:1; transform: translateY(0); filter: blur(0); }
    .tag{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      font-size: 12px;
      margin-bottom: 8px;
      color: rgba(255,255,255,.92);
    }

    .pressWrap{ margin-top: 18px; display:flex; justify-content:center; position:relative; z-index:1; }
    .press{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding: 12px 16px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(255,77,136,.85), rgba(255,46,111,.85));
      border: 1px solid rgba(255,255,255,.18);
      cursor:pointer;
      user-select:none;
      box-shadow: 0 18px 55px rgba(255,46,111,.20);
      opacity:0;
      transform: translateY(10px);
      animation: pressIn .7s var(--soft) forwards;
      animation-delay: 2.2s;
    }
    @keyframes pressIn{ to{ opacity:1; transform: translateY(0); } }
    .press:hover{ transform: translateY(-2px); }

    /* ===== Main UI ===== */
    .wrap{
      position:relative;
      z-index: 10;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .card{
      width:min(880px, 96vw);
      border-radius: 30px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      padding: 26px 22px;
      position:relative;
      overflow:hidden;
      animation: cardIn .7s var(--soft) both;
      z-index:10;
    }
    @keyframes cardIn{
      from{ transform: translateY(10px) scale(.985); opacity:0; }
      to{ transform: translateY(0) scale(1); opacity:1; }
    }
    .card::before{
      content:"";
      position:absolute;
      inset:-160px -160px auto auto;
      width: 460px;
      height: 460px;
      background: radial-gradient(circle at center, rgba(255,46,111,.52), transparent 65%);
      opacity:.55;
      transform: rotate(25deg);
      pointer-events:none;
      animation: glowShift 6.5s ease-in-out infinite alternate;
    }
    @keyframes glowShift{
      from{ transform: rotate(20deg) translate(0,0) scale(1); opacity:.50; }
      to{ transform: rotate(28deg) translate(-10px, 12px) scale(1.05); opacity:.62; }
    }

    .top{ display:flex; justify-content:space-between; align-items:flex-start; gap:14px; flex-wrap:wrap; margin-bottom:14px; }
    .title{ text-align:left; line-height:1.1; }
    h1{
      font-family: Cinzel, serif;
      margin:0;
      font-size: clamp(28px, 4.2vw, 52px);
      letter-spacing: .8px;
      text-shadow: 0 20px 55px rgba(255,46,111,.20);
    }
    .subtitle{ margin:10px 0 0; font-size: 14px; color: rgba(255,255,255,.84); max-width: 58ch; }
    .chips{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; }
    .chip{
      padding: 9px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.16);
      font-size: 13px;
      color: rgba(255,255,255,.92);
      display:inline-flex;
      align-items:center;
      white-space:nowrap;
      gap:8px;
    }

    .gameBox{
      margin-top: 10px;
      border-radius: 22px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.12);
      padding: 16px;
    }
    .gameTop{ display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; margin-bottom:12px; }
    .hud{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

    .badge{
      padding: 9px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      font-size: 13px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      transition: transform .18s var(--soft);
    }
    .meterWrap{
      flex:1;
      min-width: 220px;
      height: 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      overflow:hidden;
    }
    .meter{
      height:100%;
      width:0%;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--pink), var(--hot), var(--rose));
      transition: width .16s var(--soft);
      box-shadow: 0 0 28px rgba(255,46,111,.42);
    }

    .playArea{
      position:relative;
      height: 270px;
      border-radius: 18px;
      background:
        radial-gradient(900px 330px at 50% 0%, rgba(255,46,111,.16), transparent 55%),
        radial-gradient(550px 260px at 10% 90%, rgba(255,122,167,.12), transparent 60%),
        rgba(255,255,255,.04);
      border: 1px dashed rgba(255,255,255,.22);
      overflow:hidden;
      user-select:none;
      touch-action: manipulation;
    }
    .tapHint{
      position:absolute; left:50%; top:50%;
      transform: translate(-50%, -50%);
      font-size:14px; color: rgba(255,255,255,.78);
      text-align:center; width:80%;
      animation: hintPulse 2.2s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes hintPulse{
      0%,100%{ opacity:.75; transform: translate(-50%,-50%) scale(1); }
      50%{ opacity:.95; transform: translate(-50%,-50%) scale(1.02); }
    }

    .target{
      position:absolute;
      font-size: 36px;
      cursor:pointer;
      transform: translate(-50%, -50%);
      filter: drop-shadow(0 16px 24px rgba(255, 46, 111, .16));
      animation: bounceIn 420ms var(--soft) both;
      will-change: transform, opacity;
    }
    @keyframes bounceIn{
      0%{ transform: translate(-50%,-50%) scale(.55); opacity:.25; }
      60%{ transform: translate(-50%,-50%) scale(1.12); opacity:1; }
      85%{ transform: translate(-50%,-50%) scale(.96); }
      100%{ transform: translate(-50%,-50%) scale(1); }
    }

    .burst{
      position:absolute;
      width: 14px; height: 14px;
      border-radius: 999px;
      border: 2px solid rgba(255, 122, 167, .7);
      transform: translate(-50%, -50%);
      animation: burst 420ms var(--soft) forwards;
      pointer-events:none;
    }
    @keyframes burst{
      from{ opacity: .8; transform: translate(-50%,-50%) scale(.5); }
      to{ opacity: 0; transform: translate(-50%,-50%) scale(4.2); }
    }

    .buttons{ display:flex; justify-content:center; gap:12px; flex-wrap:wrap; margin-top:14px; position:relative; min-height:54px; }
    button{
      border:none;
      padding: 12px 18px;
      border-radius: 16px;
      font-size: 15px;
      cursor:pointer;
      transition: transform .14s var(--soft), opacity .14s var(--soft);
      color:#fff;
      position: relative;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    button:active{ transform: scale(.98); }

    .yes{ background: linear-gradient(135deg, var(--pink), var(--hot)); box-shadow: 0 18px 50px rgba(255,46,111,.22); }
    .yes:disabled{ opacity:.55; cursor:not-allowed; box-shadow:none; }
    .no{ background: rgba(255,255,255,.14); border: 1px solid rgba(255,255,255,.18); }
    .reset{ background: rgba(255,255,255,.12); border: 1px solid rgba(255,255,255,.18); }
    .footer{ margin-top:10px; font-size:12px; opacity:.72; text-align:center; }

    /* ===== Success ===== */
    .success{ display:none; text-align:center; padding: 6px 0 10px; animation: fadeUp .55s var(--soft) both; position:relative; }
    @keyframes fadeUp{ from{ transform: translateY(14px); opacity:0; } to{ transform: translateY(0); opacity:1; } }

    /* Ring surprise */
    .ringWrap{
      position: relative;
      width: 180px;
      height: 140px;
      margin: 0 auto 6px;
      opacity: 0;
      transform: translateY(10px) scale(.9);
      pointer-events: none;
    }
    .ringWrap.show{
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: opacity .35s var(--soft), transform .35s var(--soft);
    }
    .ringGlow{
      position:absolute;
      inset: -10px;
      border-radius: 999px;
      background: radial-gradient(circle at 50% 55%, rgba(255,46,111,.35), transparent 60%);
      filter: blur(1px);
      opacity: 0;
    }
    .ringWrap.show .ringGlow{ animation: ringGlow 1.6s ease-in-out forwards; }
    @keyframes ringGlow{
      0%{ opacity: 0; transform: scale(.85); }
      30%{ opacity: .85; transform: scale(1.05); }
      100%{ opacity: .25; transform: scale(1.2); }
    }

    .ring{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%) scale(.2) rotate(-8deg);
      font-size: 78px;
      filter: drop-shadow(0 18px 35px rgba(255,46,111,.25));
      opacity: 0;
    }

    /* Pop THEN continuous bounce/float */
    .ringWrap.show .ring{
      opacity: 1;
      animation:
        ringPop 900ms var(--soft) forwards,
        ringFloat 1600ms ease-in-out infinite;
      animation-delay: 0ms, 900ms;
    }

    @keyframes ringPop{
      0%{ transform: translate(-50%,-50%) scale(.2) rotate(-10deg); }
      60%{ transform: translate(-50%,-50%) scale(1.12) rotate(6deg); }
      85%{ transform: translate(-50%,-50%) scale(.96) rotate(-2deg); }
      100%{ transform: translate(-50%,-50%) scale(1) rotate(0deg); }
    }
    @keyframes ringFloat{
      0%,100%{ transform: translate(-50%,-50%) scale(1) rotate(0deg); }
      50%{ transform: translate(-50%,-56%) scale(1.03) rotate(1deg); }
    }

    .spark{
      position:absolute;
      font-size: 22px;
      opacity: 0;
      transform: scale(.6);
      filter: drop-shadow(0 10px 18px rgba(255,255,255,.12));
    }
    .spark.s1{ left: 22px; top: 10px; }
    .spark.s2{ right: 18px; top: 18px; }
    .spark.s3{ left: 18px; bottom: 10px; }
    .spark.s4{ right: 26px; bottom: 6px; }

    /* Sparkle once + continuous twinkle */
    .ringWrap.show .spark{
      animation:
        sparkle 900ms ease-in-out forwards,
        twinkle 1600ms ease-in-out infinite;
      animation-delay: 0ms, 1100ms;
    }
    .ringWrap.show .spark.s2{ animation-delay: 90ms, 1200ms; }
    .ringWrap.show .spark.s3{ animation-delay: 140ms, 1300ms; }
    .ringWrap.show .spark.s4{ animation-delay: 210ms, 1400ms; }

    @keyframes sparkle{
      0%{ opacity:0; transform: scale(.6) rotate(0deg); }
      35%{ opacity:1; transform: scale(1.2) rotate(12deg); }
      100%{ opacity:0; transform: scale(.9) rotate(28deg); }
    }
    @keyframes twinkle{
      0%,100%{ opacity:0; transform: scale(.85) rotate(0deg); }
      40%{ opacity:.75; transform: scale(1.05) rotate(10deg); }
      60%{ opacity:.25; transform: scale(.95) rotate(-8deg); }
    }

    .bigHeart{ font-size: 76px; margin: 8px 0 4px; animation: beat 1.15s ease-in-out infinite; }
    @keyframes beat{ 0%,100%{ transform: scale(1) } 50%{ transform: scale(1.09) } }
    .success h2{ font-family: Cinzel, serif; letter-spacing: .6px; margin: 4px 0 10px; }
    .loveLine{ margin-top:10px; font-family: Cinzel, serif; font-size: clamp(18px, 2.2vw, 28px); }
    .note{ color: rgba(255,255,255,.88); max-width:62ch; margin:8px auto 0; line-height:1.55; font-size:14px; }

    /* ===== Mobile optimization ===== */
    @media (max-width: 520px){
      .card{ padding: 18px 14px; border-radius: 22px; }
      h1{ font-size: 28px; }
      .subtitle{ font-size: 13px; }
      .playArea{ height: 240px; }
      button{ padding: 13px 16px; border-radius: 16px; font-size: 15px; }
      .chip{ font-size: 12px; padding: 8px 10px; }
      .introBox{ padding: 22px 16px; border-radius: 22px; }
    }
    @media (max-width: 380px){
      .playArea{ height: 220px; }
    }
  </style>
</head>

<body>
  <!-- INTRO -->
  <div class="intro" id="intro">
    <div class="introBox">
      <div class="introGlow"></div>
      <div class="scanline"></div>
      <h2 class="introTitle">VALENTINE QUEST üíû</h2>

      <div class="scene">
        <div class="line" id="l1"><div class="tag">üé¨ Scene 1</div>Welcome <b>Payal</b>‚Ä¶ a special mission awaits üíñ</div>
        <div class="line" id="l2"><div class="tag">üéÆ Objective</div>Collect <b>10 hearts</b> within <b>30 seconds</b>.</div>
        <div class="line" id="l3"><div class="tag">‚ö° Power-ups</div>üíù gives <b>+2</b>, ‚ú® gives <b>+3</b>.</div>
        <div class="line" id="l4"><div class="tag">üèÜ Reward</div>Unlock <b>YES</b> and reveal your surprise üíå</div>
      </div>

      <div class="pressWrap">
        <div class="press" id="pressStart">‚ú® Tap / Click to Start ‚ú®</div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="card">

      <div id="askScreen">
        <div class="top">
          <div class="title">
            <h1>Will You Be My Valentine? üíñ</h1>
            <p class="subtitle">
              Payal, unlock the ‚ÄúYES‚Äù button by collecting <b>10 hearts</b> within <b>30 seconds</b>.
              üíù gives bonus points.
            </p>
          </div>

          <div class="chips">
            <div class="chip">From: <b>Satyam Gohil</b></div>
            <div class="chip">To: <b>Payal Vaghela</b></div>
          </div>
        </div>

        <div class="gameBox">
          <div class="gameTop">
            <div class="hud">
              <div class="badge">üéØ Goal: <b>10</b></div>
              <div class="badge" id="scoreBadge">üíó Collected: <b id="scoreText">0</b></div>
              <div class="badge" id="timeBadge">‚è≥ Time: <b id="timeText">30</b>s</div>
            </div>

            <div class="meterWrap">
              <div class="meter" id="meter"></div>
            </div>
          </div>

          <div class="playArea" id="playArea">
            <div class="tapHint">Tap the üíó when it appears ‚ú®</div>
          </div>
        </div>

        <div class="buttons" id="btnRow">
          <button class="yes" id="yesBtn" disabled>Yes üíò (locked)</button>
          <button class="no" id="noBtn">No üôÉ</button>
          <button class="reset" id="startBtn">Start</button>
          <button class="reset" id="restartBtn">Restart</button>
        </div>

        <div class="footer">Made for Payal ‚ù§Ô∏è</div>
      </div>

      <div class="success" id="yesScreen">
        <!-- Ring Surprise -->
        <div class="ringWrap" id="ringWrap" aria-hidden="true">
          <div class="ringGlow"></div>
          <div class="ring">üíç</div>
          <div class="spark s1">‚ú®</div>
          <div class="spark s2">‚ú®</div>
          <div class="spark s3">‚ú®</div>
          <div class="spark s4">‚ú®</div>
        </div>

        <div class="bigHeart">üíñ</div>
        <h2>Yay! You said YES üòç</h2>
        <div class="loveLine">You are my favorite person in the whole world üíï</div>
        <p class="note"><b>i love you so much baku</b> ‚ù§Ô∏è</p>

        <div class="buttons" style="margin-top:16px;">
          <button class="reset" id="replayBtn">Play Again üîÅ</button>
        </div>

        <div class="footer">‚Äî Satyam</div>
      </div>

    </div>
  </div>

<script>
  /* ===== Intro reveal one-by-one ===== */
  const intro = document.getElementById("intro");
  const pressStart = document.getElementById("pressStart");
  const lines = ["l1","l2","l3","l4"].map(id => document.getElementById(id));
  lines.forEach((el, i) => setTimeout(() => el.classList.add("show"), 450 + i*420));

  /* ===== Emoji background ===== */
  const floatEmojis = ["üíó","üíñ","üíò","üíï","‚ù§Ô∏è","üíû","‚ú®","üåπ","üíù"];
  function spawnFloatingEmoji(intensity = 1){
    const count = Math.max(1, Math.round(intensity));
    for(let k=0;k<count;k++){
      const el = document.createElement("div");
      el.className = "float";
      el.textContent = floatEmojis[Math.floor(Math.random()*floatEmojis.length)];
      el.style.left = Math.random()*100 + "vw";

      const dur = 6 + Math.random()*5;
      el.style.setProperty("--dur", dur + "s");
      el.style.setProperty("--ease", "cubic-bezier(.2,.9,.2,1)");
      el.style.setProperty("--drift", (Math.random()*240 - 120) + "px");
      el.style.setProperty("--rot", (Math.random()*80 - 40) + "deg");
      el.style.setProperty("--fs", (14 + Math.random()*22) + "px");

      document.body.appendChild(el);
      setTimeout(() => el.remove(), dur*1000);
    }
  }
  setInterval(() => spawnFloatingEmoji(1), 240);

  /* ===== Smooth end emojis + cleanup ===== */
  let keepEmojisCreated = [];
  function clearKeepEmojis(){
    keepEmojisCreated.forEach(el => el.remove());
    keepEmojisCreated = [];
  }

  function spawnStayEmojis(amount = 70){
    clearKeepEmojis();
    for(let i=0;i<amount;i++){
      setTimeout(()=>{
        const el = document.createElement("div");
        el.className = "keepEmoji";
        el.textContent = floatEmojis[Math.floor(Math.random()*floatEmojis.length)];
        el.style.left = (Math.random()*100) + "vw";
        el.style.bottom = "-10px";
        el.style.setProperty("--dur", (2.0 + Math.random()*2.2) + "s");
        el.style.setProperty("--rise", (-1*(180 + Math.random()*520)) + "px");
        el.style.setProperty("--fs", (16 + Math.random()*14) + "px");

        document.body.appendChild(el);
        keepEmojisCreated.push(el);

        setTimeout(() => {
          el.style.transition = "opacity .9s ease";
          el.style.opacity = "0";
          setTimeout(() => el.remove(), 900);
        }, 6500);
      }, i * 45);
    }
  }

  /* ===== Game ===== */
  const GOAL = 10, GAME_SECONDS = 30;

  const playArea = document.getElementById("playArea");
  const startBtn = document.getElementById("startBtn");
  const restartBtn = document.getElementById("restartBtn");
  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");
  const btnRow = document.getElementById("btnRow");

  const scoreText = document.getElementById("scoreText");
  const timeText = document.getElementById("timeText");
  const meter = document.getElementById("meter");

  const scoreBadge = document.getElementById("scoreBadge");
  const timeBadge = document.getElementById("timeBadge");

  const askScreen = document.getElementById("askScreen");
  const yesScreen = document.getElementById("yesScreen");
  const replayBtn = document.getElementById("replayBtn");

  const ringWrap = document.getElementById("ringWrap");

  let score=0, timeLeft=GAME_SECONDS, timer=null, spawner=null, running=false;

  function clearTargets(){ playArea.querySelectorAll(".target").forEach(t => t.remove()); }

  function resetUI(){
    score=0; timeLeft=GAME_SECONDS;
    scoreText.textContent=score;
    timeText.textContent=timeLeft;
    meter.style.width="0%";
    yesBtn.disabled=true;
    yesBtn.textContent="Yes üíò (locked)";
    clearTargets();
  }

  function bump(el){
    el.style.transform = "translateY(-1px) scale(1.05)";
    setTimeout(()=> el.style.transform = "", 180);
  }

  function updateMeter(){
    const pct = Math.min(100, Math.round((score/GOAL)*100));
    meter.style.width = pct + "%";
    scoreText.textContent = score;
    bump(scoreBadge);
    if(score >= GOAL){
      yesBtn.disabled=false;
      yesBtn.textContent="Yes üíò (unlocked)";
      spawnFloatingEmoji(3);
    }
  }

  function rand(min, max){ return Math.random()*(max-min)+min; }

  function addBurst(x,y){
    const b=document.createElement("div");
    b.className="burst";
    b.style.left=x+"px";
    b.style.top=y+"px";
    playArea.appendChild(b);
    setTimeout(()=>b.remove(),450);
  }

  function spawnTarget(){
    if(!running) return;
    const rect = playArea.getBoundingClientRect();
    const t=document.createElement("div");
    t.className="target";

    const r=Math.random();
    t.textContent = r < 0.82 ? "üíó" : (r < 0.96 ? "üíù" : "‚ú®");
    const points = (t.textContent==="üíù") ? 2 : (t.textContent==="‚ú®" ? 3 : 1);

    const x = rand(36, rect.width-36);
    const y = rand(36, rect.height-36);
    t.style.left=x+"px";
    t.style.top=y+"px";

    t.addEventListener("click",(e)=>{
      e.stopPropagation();
      if(!running) return;
      score += points;
      updateMeter();
      addBurst(x,y);
      t.remove();
      spawnFloatingEmoji(2);
    });

    playArea.appendChild(t);
    const life = 820 + Math.random()*750;
    setTimeout(()=>{ if(t.isConnected) t.remove(); }, life);
  }

  function stopGame(){
    running=false;
    clearInterval(timer); clearInterval(spawner);
    timer=null; spawner=null;
    clearTargets();
    if(score < GOAL){
      yesBtn.disabled=true;
      yesBtn.textContent="Yes üíò (locked)";
    }
  }

  function startGame(){
    stopGame();
    running=true;
    resetUI();

    timer=setInterval(()=>{
      timeLeft--;
      timeText.textContent=timeLeft;
      bump(timeBadge);
      if(timeLeft<=0) stopGame();
    },1000);

    spawner=setInterval(spawnTarget,560);
  }

  startBtn.addEventListener("click", startGame);
  restartBtn.addEventListener("click", startGame);

  /* NO button: impossible but mobile-safe */
  function moveNoButton(){
    const row = btnRow.getBoundingClientRect();
    const btn = noBtn.getBoundingClientRect();
    const pad = window.innerWidth < 520 ? 12 : 6;

    const maxX = row.width - btn.width - pad;
    const maxY = row.height - btn.height - pad;

    const x = rand(pad, Math.max(pad, maxX));
    const y = rand(pad, Math.max(pad, maxY));

    noBtn.style.position="absolute";
    noBtn.style.left=x+"px";
    noBtn.style.top=y+"px";
  }
  noBtn.addEventListener("mouseenter", ()=>{ moveNoButton(); spawnFloatingEmoji(1); });
  noBtn.addEventListener("mousedown", ()=>{ moveNoButton(); spawnFloatingEmoji(2); });
  noBtn.addEventListener("click", (e)=>{ e.preventDefault(); moveNoButton(); spawnFloatingEmoji(2); });

  document.addEventListener("touchstart", (e)=>{
    const t=e.touches[0];
    const r=noBtn.getBoundingClientRect();
    const near = Math.abs(t.clientX-(r.left+r.width/2))<110 && Math.abs(t.clientY-(r.top+r.height/2))<110;
    if(near) moveNoButton();
  }, {passive:true});

  /* YES flow */
  yesBtn.addEventListener("click", ()=>{
    if(yesBtn.disabled) return;
    stopGame();

    askScreen.style.display="none";
    yesScreen.style.display="block";

    // ring surprise reset then play
    ringWrap.classList.remove("show");
    void ringWrap.offsetWidth;
    ringWrap.classList.add("show");

    for(let i=0;i<16;i++) setTimeout(()=>spawnFloatingEmoji(3), i*120);
    spawnStayEmojis(70);
  });

  /* Play Again */
  replayBtn.addEventListener("click", ()=>{
    clearKeepEmojis();
    ringWrap.classList.remove("show");
    yesScreen.style.display="none";
    askScreen.style.display="block";
    startGame();
  });

  /* Intro Start */
  pressStart.addEventListener("click", ()=>{
    intro.classList.add("fadeOut");
    setTimeout(()=> intro.style.display="none", 900);
    resetUI();
  });

  /* Initial */
  resetUI();
</script>
</body>
</html>
